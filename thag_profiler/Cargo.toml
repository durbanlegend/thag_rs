[package]
name = "thag_profiler"
version = "0.1.0"
edition = "2021"

[dependencies]
backtrace = "0.3"
chrono = "0.4.39"
dirs = { version = "6.0", optional = true }
# futures = "0.3.31"
inferno = { version = "0.12.0", optional = true }
inquire = { version = "0.7.5", optional = true }
once_cell = "1.20.3"
ra_ap_syntax = { version = "0.0.264", optional = true }
serde = { version = "1.0.219", features = ["derive"] }
serde_json = { version = "1.0.140", optional = true }
strum = { version = "0.27.1", features = ["derive", "phf"] }
thag_proc_macros = { path = "../thag_proc_macros", default-features = false }
parking_lot = { version = "0.12.3", default-features = false }
regex = { version = "1.11.1", default-features = false }
paste = "1.0.15"

[dev-dependencies]
regex = "1.11.1"
serial_test = { version = "3.2.0", features = ["file_locks"] }
smol = "2.0.2"
tokio = { version = "1.36.0", features = ["rt", "macros", "time"] }
async-std = { version = "1.12.0", features = ["attributes"] }

[features]
analyze-tool = ["dirs", "inferno", "inquire", "ra_ap_syntax", "serde_json"]
default = ["full_profiling"]
time_profiling = ["thag_proc_macros/time_profiling"]
full_profiling = ["time_profiling", "thag_proc_macros/full_profiling"]
tools = ["analyze-tool", "instrument-tool"]                                 # Enable all tools
instrument-tool = ["ra_ap_syntax"]                                          # Dependencies for instrument

[[bin]]
name = "thag-analyze"
path = "src/bin/analyze.rs"
required-features = ["analyze-tool"]

[[bin]]
name = "thag-instrument"
path = "src/bin/instrument.rs"
required-features = ["instrument-tool"]

[[bin]]
name = "thag-remove"
path = "src/bin/remove.rs"
required-features = ["instrument-tool"]
